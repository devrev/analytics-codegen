# Input

Generate the data source for this query, given the following guide:
<insert ds-7.3.md here>

# Output

## 4: Email communication analysis by sender domain

```json
"data_sources": [
  {
    "dimensions": [
      {
        "devrev_schema": {
          "field_type": "text",
          "is_filterable": true,
          "name": "article_title",
          "ui": {
            "display_name": "Article Title"
          }
        },
        "meerkat_schema": {
          "sql_expression": "title",
          "type": "string"
        },
        "reference_name": "article_title"
      },
      {
        "devrev_schema": {
          "field_type": "id",
          "id_type": ["work"],
          "is_filterable": true,
          "name": "article_id",
          "ui": {
            "display_name": "Article ID"
          }
        },
        "meerkat_schema": {
          "sql_expression": "article_id",
          "type": "string"
        },
        "reference_name": "article_id"
      },
      {
        "devrev_schema": {
          "field_type": "timestamp",
          "is_filterable": true,
          "name": "created_date",
          "ui": {
            "display_name": "Created Date"
          }
        },
        "meerkat_schema": {
          "sql_expression": "created_date",
          "type": "time"
        },
        "reference_name": "created_date"
      },
      {
        "devrev_schema": {
          "field_type": "text",
          "is_filterable": true,
          "name": "related_incident",
          "ui": {
            "display_name": "Related Incident"
          }
        },
        "meerkat_schema": {
          "sql_expression": "related_incident",
          "type": "string"
        },
        "reference_name": "related_incident"
      }
    ],
    "measures": [
      {
        "devrev_schema": {
          "field_type": "int",
          "is_filterable": false,
          "name": "net_votes",
          "ui": {
            "display_name": "Net Votes"
          }
        },
        "meerkat_schema": {
          "sql_expression": "net_votes",
          "type": "number"
        },
        "reference_name": "net_votes"
      },
      {
        "devrev_schema": {
          "field_type": "int",
          "is_filterable": false,
          "name": "total_views",
          "ui": {
            "display_name": "Total Views",
            "is_compact": true
          }
        },
        "meerkat_schema": {
          "sql_expression": "total_views",
          "type": "number"
        },
        "reference_name": "total_views"
      },
      {
        "devrev_schema": {
          "field_type": "int",
          "is_filterable": false,
          "name": "unique_views",
          "ui": {
            "display_name": "Unique Views",
            "is_compact": true
          }
        },
        "meerkat_schema": {
          "sql_expression": "unique_views",
          "type": "number"
        },
        "reference_name": "unique_views"
      },
      {
        "devrev_schema": {
          "field_type": "double",
          "is_filterable": false,
          "name": "avg_view_duration",
          "ui": {
            "display_name": "Average View Duration",
            "unit": "seconds",
            "precision": 1
          }
        },
        "meerkat_schema": {
          "sql_expression": "avg_view_duration_seconds",
          "type": "number"
        },
        "reference_name": "avg_view_duration"
      }
    ],
    "oasis": {
      "datasets": ["system.dim_article", "system.article_views_and_votes_summary", "system.dim_incident"],
      "sql_query": "WITH article_performance AS (SELECT a.title, a.id AS article_id, a.created_date, a.num_upvotes - a.num_downvotes AS net_votes, a.applies_to_part_ids, SUM(avs.total_views) AS total_views, SUM(avs.unique_views) AS unique_views, AVG(avs.total_duration_ms) / 1000.0 AS avg_view_duration_seconds FROM system.dim_article a JOIN system.article_views_and_votes_summary avs ON a.id = avs.article_id WHERE a.is_deleted = FALSE AND avs.record_date >= DATE '2023-01-01' AND a.status = 'published' GROUP BY a.title, a.id, a.created_date, a.num_upvotes, a.num_downvotes, a.applies_to_part_ids), article_incidents AS (SELECT ap.article_id, unnest(ap.applies_to_part_ids) AS incident_id FROM article_performance ap WHERE ap.applies_to_part_ids IS NOT NULL) SELECT ap.title, ap.article_id, ap.created_date, ap.net_votes, ap.total_views, ap.unique_views, ap.avg_view_duration_seconds, i.title AS related_incident, i.severity_json FROM article_performance ap LEFT JOIN article_incidents ai ON ap.article_id = ai.article_id LEFT JOIN system.dim_incident i ON ai.incident_id = i.id ORDER BY ap.total_views DESC LIMIT 15"
    },
    "reference_name": "article_performance_with_incidents",
    "type": "oasis"
  }
]
```

## 6: User engagement statistics with verification status

```json
{
  "data_sources": [
    {
      "dimensions": [
        {
          "devrev_schema": {
            "field_type": "timestamp",
            "is_filterable": true,
            "name": "created_at",
            "ui": {
              "display_name": "Creation Date"
            }
          },
          "meerkat_schema": {
            "sql_expression": "created_at",
            "type": "time"
          },
          "reference_name": "created_at"
        },
        {
          "devrev_schema": {
            "allowed_values": [true, false],
            "field_type": "enum",
            "is_filterable": true,
            "name": "is_verified",
            "ui": {
              "display_name": "Verification Status"
            }
          },
          "meerkat_schema": {
            "sql_expression": "is_verified",
            "type": "string"
          },
          "reference_name": "is_verified"
        },
        {
          "devrev_schema": {
            "field_type": "id",
            "id_type": ["rev_user"],
            "is_filterable": true,
            "name": "rev_oid",
            "ui": {
              "display_name": "User ID"
            }
          },
          "meerkat_schema": {
            "sql_expression": "rev_oid",
            "type": "string"
          },
          "reference_name": "rev_oid"
        }
      ],
      "measures": [
        {
          "devrev_schema": {
            "field_type": "int",
            "is_filterable": false,
            "name": "active_users",
            "ui": {
              "display_name": "Active Users",
              "is_compact": true
            }
          },
          "meerkat_schema": {
            "sql_expression": "COUNT(DISTINCT rev_oid)",
            "type": "number"
          },
          "reference_name": "active_users"
        },
        {
          "devrev_schema": {
            "field_type": "int",
            "is_filterable": false,
            "name": "total_sessions",
            "ui": {
              "display_name": "Total Sessions",
              "is_compact": true
            }
          },
          "meerkat_schema": {
            "sql_expression": "SUM(total_user_sessions)",
            "type": "number"
          },
          "reference_name": "total_sessions"
        },
        {
          "devrev_schema": {
            "field_type": "double",
            "is_filterable": false,
            "name": "total_hours_spent",
            "ui": {
              "display_name": "Total Hours Spent",
              "precision": 2
            }
          },
          "meerkat_schema": {
            "sql_expression": "SUM(total_session_length) / 3600.0",
            "type": "number"
          },
          "reference_name": "total_hours_spent"
        },
        {
          "devrev_schema": {
            "field_type": "double",
            "is_filterable": false,
            "name": "avg_session_length_sec",
            "ui": {
              "display_name": "Avg Session Length (sec)",
              "precision": 2,
              "unit": "seconds"
            }
          },
          "meerkat_schema": {
            "sql_expression": "SUM(total_session_length) / SUM(total_user_sessions)",
            "type": "number"
          },
          "reference_name": "avg_session_length_sec"
        },
        {
          "devrev_schema": {
            "field_type": "int",
            "is_filterable": false,
            "name": "total_events",
            "ui": {
              "display_name": "Total Events",
              "is_compact": true
            }
          },
          "meerkat_schema": {
            "sql_expression": "SUM(total_events)",
            "type": "number"
          },
          "reference_name": "total_events"
        },
        {
          "devrev_schema": {
            "field_type": "double",
            "is_filterable": false,
            "name": "events_per_session",
            "ui": {
              "display_name": "Events per Session",
              "precision": 2
            }
          },
          "meerkat_schema": {
            "sql_expression": "SUM(total_events)::FLOAT / SUM(total_user_sessions)",
            "type": "number"
          },
          "reference_name": "events_per_session"
        }
      ],
      "oasis": {
        "datasets": ["system.user_sessions_track_events_summary_v2"],
        "sql_query": "SELECT * FROM system.user_sessions_track_events_summary_v2 WHERE created_at >= TIMESTAMP '2023-01-01 00:00:00'"
      },
      "reference_name": "user_engagement_stats",
      "type": "oasis"
    }
  ]
}
```

## 10: Cross-domain analysis of user engagement, article usage, and costs (three-table join)

```json
{
  "data_sources": [
    {
      "dimensions": [
        {
          "devrev_schema": {
            "field_type": "timestamp",
            "is_filterable": true,
            "name": "month",
            "ui": {
              "display_name": "Month"
            }
          },
          "meerkat_schema": {
            "sql_expression": "month",
            "type": "time"
          },
          "reference_name": "month"
        },
        {
          "devrev_schema": {
            "field_type": "text",
            "is_filterable": true,
            "name": "is_verified",
            "ui": {
              "display_name": "Verification Status"
            }
          },
          "meerkat_schema": {
            "sql_expression": "is_verified",
            "type": "string"
          },
          "reference_name": "is_verified"
        }
      ],
      "measures": [
        {
          "devrev_schema": {
            "field_type": "int",
            "is_filterable": false,
            "name": "active_users",
            "ui": {
              "display_name": "Active Users",
              "is_compact": true
            }
          },
          "meerkat_schema": {
            "sql_expression": "active_users",
            "type": "number"
          },
          "reference_name": "active_users"
        },
        {
          "devrev_schema": {
            "field_type": "int",
            "is_filterable": false,
            "name": "total_events",
            "ui": {
              "display_name": "Total Events",
              "is_compact": true
            }
          },
          "meerkat_schema": {
            "sql_expression": "total_events",
            "type": "number"
          },
          "reference_name": "total_events"
        },
        {
          "devrev_schema": {
            "field_type": "double",
            "is_filterable": false,
            "name": "events_per_user",
            "ui": {
              "display_name": "Events Per User",
              "precision": 2
            }
          },
          "meerkat_schema": {
            "sql_expression": "events_per_user",
            "type": "number"
          },
          "reference_name": "events_per_user"
        },
        {
          "devrev_schema": {
            "field_type": "int",
            "is_filterable": false,
            "name": "viewed_articles",
            "ui": {
              "display_name": "Articles Viewed",
              "is_compact": true
            }
          },
          "meerkat_schema": {
            "sql_expression": "viewed_articles",
            "type": "number"
          },
          "reference_name": "viewed_articles"
        },
        {
          "devrev_schema": {
            "field_type": "int",
            "is_filterable": false,
            "name": "total_views",
            "ui": {
              "display_name": "Total Article Views",
              "is_compact": true
            }
          },
          "meerkat_schema": {
            "sql_expression": "total_views",
            "type": "number"
          },
          "reference_name": "total_views"
        },
        {
          "devrev_schema": {
            "field_type": "double",
            "is_filterable": false,
            "name": "views_per_user",
            "ui": {
              "display_name": "Views Per User",
              "precision": 2
            }
          },
          "meerkat_schema": {
            "sql_expression": "views_per_user",
            "type": "number"
          },
          "reference_name": "views_per_user"
        },
        {
          "devrev_schema": {
            "field_type": "double",
            "is_filterable": false,
            "name": "total_hours_spent",
            "ui": {
              "display_name": "Total Hours Spent",
              "unit": "hours",
              "precision": 2
            }
          },
          "meerkat_schema": {
            "sql_expression": "total_hours_spent",
            "type": "number"
          },
          "reference_name": "total_hours_spent"
        },
        {
          "devrev_schema": {
            "field_type": "double",
            "is_filterable": false,
            "name": "hours_per_user",
            "ui": {
              "display_name": "Hours Per User",
              "unit": "hours",
              "precision": 2
            }
          },
          "meerkat_schema": {
            "sql_expression": "hours_per_user",
            "type": "number"
          },
          "reference_name": "hours_per_user"
        },
        {
          "devrev_schema": {
            "field_type": "double",
            "is_filterable": false,
            "name": "aws_cost",
            "ui": {
              "display_name": "AWS Cost",
              "is_currency_field": true,
              "unit": "USD",
              "precision": 2
            }
          },
          "meerkat_schema": {
            "sql_expression": "aws_cost",
            "type": "number"
          },
          "reference_name": "aws_cost"
        },
        {
          "devrev_schema": {
            "field_type": "double",
            "is_filterable": false,
            "name": "cost_per_user",
            "ui": {
              "display_name": "Cost Per User",
              "is_currency_field": true,
              "unit": "USD",
              "precision": 2
            }
          },
          "meerkat_schema": {
            "sql_expression": "cost_per_user",
            "type": "number"
          },
          "reference_name": "cost_per_user"
        }
      ],
      "oasis": {
        "datasets": [
          "system.user_sessions_track_events_summary_v2",
          "system.article_views_and_votes_summary",
          "memory.aws_daily_cost_v7"
        ],
        "sql_query": "WITH user_activity AS (\n    SELECT\n        DATE_TRUNC('month', created_at) AS month,\n        is_verified,\n        COUNT(DISTINCT rev_oid) AS active_users,\n        SUM(total_events) AS total_events\n    FROM\n        system.user_sessions_track_events_summary_v2\n    WHERE\n        created_at >= TIMESTAMP '2023-01-01 00:00:00'\n    GROUP BY\n        DATE_TRUNC('month', created_at),\n        is_verified\n),\narticle_usage AS (\n    SELECT\n        DATE_TRUNC('month', record_date) AS month,\n        is_verified,\n        COUNT(DISTINCT article_id) AS viewed_articles,\n        SUM(total_views) AS total_views,\n        SUM(total_duration_ms) / 1000.0 / 3600 AS total_hours_spent\n    FROM\n        system.article_views_and_votes_summary\n    WHERE\n        record_date >= DATE '2023-01-01'\n    GROUP BY\n        DATE_TRUNC('month', record_date),\n        is_verified\n),\nmonthly_costs AS (\n    SELECT\n        DATE_TRUNC('month', usage_date::DATE) AS month,\n        SUM(cost) AS aws_cost\n    FROM\n        memory.aws_daily_cost_v7\n    WHERE\n        usage_date::DATE >= DATE '2023-01-01'\n    GROUP BY\n        DATE_TRUNC('month', usage_date::
```
